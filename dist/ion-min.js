function randomNumber(min,max,frac){var num=Math.random()*(max-min)+min;if(!frac)var num=Math.floor(num);return num}function randomRGBA(){return"rgba("+randomNumber(0,255)+","+randomNumber(0,255)+","+randomNumber(.255)+","+randomNumber(0,1,!0)+")"}function convertHex(hex,opacity){return hex=hex.replace("#",""),r=parseInt(hex.substring(0,2),16),g=parseInt(hex.substring(2,4),16),b=parseInt(hex.substring(4,6),16),opacity||(opacity=1),result="rgba("+r+","+g+","+b+","+opacity/100+")",result}function colorArray(rgbaString){return p.color.match(/(\d{1,4})/g)}function getAbsValue(val){var abs=Math.abs(parseFloat(val));return val.match("-")&&(abs=-abs),abs}function decimalPlaces(num){var match=(""+num).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return match?Math.max(0,(match[1]?match[1].length:0)-(match[2]?+match[2]:0)):0}function defaultOptions(standard,user){if("object"==typeof user)for(var key in standard)void 0!=user[key]&&(standard[key]=user[key]);return standard}var Particle=function(particleOptions,ion){var particle=this;particle.ion=ion,particle.init(particleOptions),particle.draw()};Particle.prototype.setProperty=function(opts){var p=this,val=opts.value,prop=opts.property;"random"==val?opts.acceptedValues?p[prop]=opts.acceptedValues[randomNumber(0,opts.acceptedValues.length)]:"color"==opts.randomize?p[prop]=randomRGBA():p[prop]=randomNumber(randomize[0],randomize[1],!0):isArray(val)?val.length>2?p[prop]=val[randomNumber(0,val.length)]:p[prop]=randomNumber(val[0],val[1]):p[prop]=val},Particle.prototype.init=function(o){var p=this;switch(p.setProperty({property:"color",value:o.color,randomize:"color"}),p.color.indexOf("#")>=0&&(p.color=convertHex(p.color,1)),p.colorArray=p.color.match(/(\d{1,4})/g),p.setProperty({property:"borderColor",value:o.borderColor,randomize:"color"}),p.setProperty({property:"borderWidth",value:o.borderWidth,randomize:[0,10]}),p.setProperty({property:"size",value:o.size,randomize:[1,.5*p.ion.canvas.width]}),p.setProperty({property:"shape",value:o.shape,acceptedValues:Object.keys(p.ion.shapes)}),p.setProperty({property:"gravity",value:o.gravity,randomize:[-5,5]}),p.setProperty({property:"wind",value:o.wind,randomize:[-5,5]}),p.setProperty({property:"orient",value:o.orient,randomize:[0,360]}),p.setProperty({property:"death",value:o.death,randomize:[0,3e3]}),p.life=0,p.setProperty({property:"fade",value:o.fade,acceptedValues:["in","out","in-out"]}),p.setProperty({property:"fadeSpeed",value:o.fadeSpeed,randomize:[0,20]}),"in"==p.fade||"in-out"==p.fade?p.opacity=0:"out"==p.fade?p.opacity=1:p.opacity=p.colorArray[3],o.origin[0]){case"left":p.x=2*-p.size;break;case"right":p.x=ion.canvas.width+2*p.size;break;case"center":p.x=.5*ion.canvas.width;break;case"random":p.x=Math.floor(randomNumber(2*-p.size,p.ion.canvas.width+2*p.size));break;default:p.x=o.origin[0]}switch(o.origin[1]){case"top":p.y=2*-p.size;break;case"bottom":p.y=ion.canvas.height+2*p.size;break;case"center":p.y=.5*ion.canvas.height;break;case"random":var min=2*-p.size,max=p.ion.canvas.height+2*p.size;p.y=Math.floor(randomNumber(min,max));break;default:p.y=o.origin[1]}switch(p.setProperty({property:"rotationDirection",value:o.rotationDirection,acceptedValues:["clockwise","counter-clockwise","random"]}),p.setProperty({property:"rotationVelocity",value:o.rotationVelocity,randomize:[0,10]}),p.rotationDirection){case"clockwise":p.rotation=.01*p.rotationVelocity;break;case"counter-clockwise":p.rotation=.01*-p.rotationVelocity;break;case"random":var chance=randomNumber(0,100);chance>50?p.rotation=.01*p.rotationVelocity:p.rotation=.01*p.roationVelocity}},Particle.prototype.render=function(shape){var particle=this,context=particle.ion.context;context.fillStyle=particle.color,context.strokeStyle=particle.borderColor,context.lineWidth=particle.borderWidth,context.save(),particle.ion.shapes[shape](particle),context.restore()},Particle.prototype.draw=function(){var particle=this,ion=particle.ion,canvas=ion.canvas,context=ion.context;if(particle.y+=particle.gravity,particle.x+=particle.wind,particle.life++,"clockwise"==particle.rotationDirection?particle.rotation+=particle.rotationVelocity:particle.rotation-=particle.rotationVelocity,particle.fade){switch(particle.fadeStop===!1&&particle.opacity>=1&&(particle.fade="out"),particle.fade){case"in":particle.opacity=particle.opacity+particle.fadeSpeed;break;case"out":particle.opacity=particle.opacity-particle.fadeSpeed}particle.color="rgba("+particle.colorArray[0]+","+particle.colorArray[1]+","+particle.colorArray[2]+","+particle.opacity+")"}context.clearRect(canvas.width,canvas.height,canvas.width,canvas.height),particle.render(particle.shape,particle.x,particle.y,particle.size,particle.size,particle.rotation,particle.color,particle.rotationDirection),(particle.life>particle.death&&0!=particle.death||particle.gravity>0&&particle.y>canvas.height+2*particle.size||particle.gravity<0&&particle.y<2*-particle.size||particle.wind<0&&particle.x<2*-particle.size||particle.wind>0&&particle.x>canvas.width+2*particle.size)&&delete ion.particleTracker[particle.id]};var Ion=function(el,particles,options){var ion=this;ion.setOptions(options),ion.particleTracker={},ion.particleIndex=0,ion.canvas=document.getElementById(el),ion.context=ion.canvas.getContext("2d"),ion.sizeCanvas(),window.onresize=function(){ion.sizeCanvas()},ion.init(),particles&&(ion.setParticles(particles),ion.start())};Ion.prototype.sizeCanvas=function(){var ion=this,width=ion.canvas.getAttribute("width"),height=ion.canvas.getAttribute("height");width||(width=window.getComputedStyle(ion.canvas.parentElement,null).width),height||(height=window.getComputedStyle(ion.canvas.parentElement,null).height),ion.canvas.setAttribute("width",width),ion.canvas.setAttribute("height",height)},Ion.prototype.stop=function(){clearInterval(this.animate)},Ion.prototype.setParticles=function(particles){var ion=this;if(!particles.length){var particle=particles;particles=new Array,particles.push(particle)}for(var p=0;p<particles.length;p++)particles[p]=defaultOptions({shape:"circle",color:"rgba(0,0,0,1)",opacity:1,borderColor:"rbga(0,0,0,0)",borderWidth:0,borderOpacity:1,size:[10,90],rotationDirection:"clockwise",rotationVelocity:.1,orient:0,death:100,fade:!1,fadeSpeed:.01,grow:!1,gravity:1,wind:1,density:20,spawnOrigin:["random","top"],origin:["random","random"],spawnRate:2},particles[p]);ion.particles=particles},Ion.prototype.setOptions=function(opts){var ion=this;options=defaultOptions({frameRate:30,canvasBackground:"rgba(255,255,255,1)"},opts),ion.frameRate=options.frameRate,ion.canvasBackground=options.canvasBackground},Ion.prototype.createParticle=function(par){var particle=new Particle(par,this);this.particleTracker[this.particleIndex]=particle,particle.id=this.particleIndex,this.particleIndex++},Ion.prototype.addShape=function(id,instructions){this.shapes[id]=instructions},Ion.prototype.init=function(){this.shapes={circle:drawCircle,square:drawSquare}},Ion.prototype.start=function(){for(var ion=this,t=0;t<ion.particles.length;t++)for(var par=ion.particles[t],d=0;d<par.density;d++)ion.createParticle(par);ion.animate=setInterval(function(){ion.context.fillStyle=ion.canvasBackground,ion.context.fillRect(0,0,ion.canvas.width,ion.canvas.height);for(var s=0;s<ion.particles.length;s++){var par=ion.particles[s];par.origin=par.spawnOrigin,par.spawnRate>0&&randomNumber(0,25*par.density)<par.spawnRate&&ion.createParticle(par)}for(var p in ion.particleTracker)ion.particleTracker[p].draw()},ion.frameRate)};var drawCircle=function(p){var ctx=p.ion.context;randomNumber(p.minSize,p.maxSize);ctx.translate(p.x,p.y),ctx.moveTo(p.x,p.y),ctx.beginPath(),ctx.arc(30,30,p.size,0,2*Math.PI,!0),ctx.fill(),p.borderWidth&&ctx.stroke(),ctx.closePath()},drawSquare=function(p){var ctx=p.ion.context;ctx.translate(p.x,p.y),p.rotation&&(ctx.rotate(p.orient+p.rotationVelocity),p.orient++),ctx.moveTo(p.x,p.y),ctx.beginPath(),ctx.rect(0,0,p.size,p.size),ctx.fill(),p.borderWidth&&ctx.stroke(),ctx.closePath()};isArray=function(val){return"[object Array]"==Object.prototype.toString.call(val)};